---
layout: post
---
<div data-lang="en">
    Preferred script for Tamil text
    <form>
        <select id="select-xlit-ta">
            <option value="knda">ಕನ್ನಡ
            <option value="latn">Latin
            <option value="mlym">മലയാളം
            <option value="taml" selected>தமிழ்
            <option value="telu">తెలుగు
        </select>
    </form>
    Preferred script for Sanskrit text
    <form>
        <select id="select-xlit-sa">
            <option value="deva">देवनागरी
            <option value="gran" selected>𑌗𑍍𑌰𑌨𑍍𑌥𑌲𑌿𑌪𑌿𑌃
            <option value="latn">Latin
        </select>
    </form>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script type="text/javascript" data-lang="en">
    let onSelectValueChange = function (selectId, eventHandler) {
        let previous;
        $(selectId).on('focus', function () {
            previous = this.value;
        }).change(function() {
            eventHandler(previous, this.value);
            previous = this.value;
        });
    };

    onSelectValueChange('#select-xlit-ta', xlit_data.bind(undefined, "ta"));
    onSelectValueChange('#select-xlit-sa', xlit_data.bind(undefined, "sa"));

    function xlit_data(lang_code, src_script, dst_script) {
        if (dst_script == "latn") {
            latn_xlit_data(lang_code, src_script, brahmiya_to_latn);
            return;
        }
        if (src_script == "latn") {
            latn_xlit_data(lang_code, dst_script, latn_to_brahmiya);
            return;
        }

        latn_xlit_data(lang_code, src_script, brahmiya_to_latn);
        latn_xlit_data(lang_code, dst_script, latn_to_brahmiya);
    }

    function latn_xlit_data(lang_code, other_script, converter) {
        let lang_matched = document.documentElement.lang == lang_code;

        let title = $(".post-title")[0];
        if (lang_matched) {
            title.textContent = converter(other_script, title.textContent);
        }

        let content = $(".post-content")[0];
        (function walk(node, lang_matched) {
            if (node.nodeType == Node.TEXT_NODE && lang_matched) {
                node.textContent = converter(other_script, node.textContent);
                return;
            }
            if (node.nodeType == Node.ELEMENT_NODE) {
                let lang = node.dataset["lang"];
                if (lang) {
                    lang_matched = (lang == lang_code);
                }
            }
            node = node.firstChild;
            while (node) {
                walk(node, lang_matched);
                node = node.nextSibling;
            }
        })(content, lang_matched);
    }
</script>

<script type="text/javascript" src="/assets/js/script_changer.js"></script>

{{ content }}
